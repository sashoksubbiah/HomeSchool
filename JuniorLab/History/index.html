<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>â° Time Machine - JuniorLab</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Fredoka+One&family=Nunito:wght@400;600;700;800&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Nunito', sans-serif;
            background: linear-gradient(135deg, #2d1b69 0%, #7b2cbf 50%, #c77dff 100%);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .top-bar {
            background: rgba(0, 0, 0, 0.3);
            padding: 12px 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
            backdrop-filter: blur(10px);
        }

        .back-home {
            display: flex;
            align-items: center;
            gap: 10px;
            color: #fff;
            text-decoration: none;
            font-weight: 700;
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.15);
            border-radius: 50px;
        }

        .game-stats {
            display: flex;
            gap: 20px;
            color: #fff;
        }

        .stat {
            display: flex;
            align-items: center;
            gap: 8px;
            background: rgba(255, 255, 255, 0.15);
            padding: 8px 18px;
            border-radius: 25px;
            font-weight: 700;
        }

        /* Audio Controls */
        .audio-control {
            position: fixed;
            top: 80px;
            right: 20px;
            z-index: 100;
            display: flex;
            gap: 10px;
        }

        .audio-btn {
            padding: 12px 20px;
            background: rgba(255, 255, 255, 0.9);
            border: none;
            border-radius: 50px;
            font-weight: 700;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
            color: #333;
        }

        .audio-btn:hover {
            transform: scale(1.05);
        }

        .audio-btn.active {
            background: linear-gradient(45deg, #7b2cbf, #c77dff);
            color: #fff;
        }

        /* Teacher Character */
        .teacher {
            position: fixed;
            bottom: 20px;
            left: 20px;
            z-index: 1000;
        }

        .teacher-avatar {
            font-size: 5rem;
            cursor: pointer;
            animation: teacherBounce 2s infinite;
            filter: drop-shadow(0 10px 20px rgba(0, 0, 0, 0.3));
        }

        @keyframes teacherBounce {

            0%,
            100% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-10px);
            }
        }

        .teacher-bubble {
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: #fff;
            color: #333;
            padding: 20px 25px;
            border-radius: 20px;
            max-width: 350px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            margin-bottom: 15px;
            display: none;
            line-height: 1.6;
        }

        .teacher-bubble.show {
            display: block;
            animation: bubbleIn 0.3s ease;
        }

        @keyframes bubbleIn {
            from {
                opacity: 0;
                transform: translateX(-50%) translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateX(-50%) translateY(0);
            }
        }

        .teacher-bubble::after {
            content: '';
            position: absolute;
            bottom: -12px;
            left: 50%;
            transform: translateX(-50%);
            border: 8px solid transparent;
            border-top-color: #fff;
        }

        .teacher-name {
            font-family: 'Fredoka One', cursive;
            color: #7b2cbf;
            margin-bottom: 8px;
        }

        .speak-btn {
            background: linear-gradient(45deg, #7b2cbf, #c77dff);
            color: #fff;
            border: none;
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: 700;
            cursor: pointer;
            margin-top: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .speak-btn.speaking {
            animation: pulse 1s infinite;
        }

        @keyframes pulse {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0.6;
            }
        }

        .container {
            max-width: 1100px;
            margin: 0 auto;
            padding: 30px 20px;
        }

        .level-header {
            text-align: center;
            margin-bottom: 30px;
            color: #fff;
        }

        .level-title {
            font-family: 'Fredoka One', cursive;
            font-size: 2.5rem;
            text-shadow: 3px 3px 0 rgba(0, 0, 0, 0.3);
        }

        .level-subtitle {
            opacity: 0.9;
            margin-top: 10px;
        }

        .missions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 25px;
        }

        .mission-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 25px;
            padding: 25px;
            color: #333;
            cursor: pointer;
            transition: all 0.4s;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            border-top: 5px solid #7b2cbf;
            position: relative;
        }

        .mission-card:hover {
            transform: translateY(-10px) scale(1.02);
        }

        .mission-card.completed::after {
            content: 'âœ…';
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 1.5rem;
        }

        .mission-icon {
            font-size: 3.5rem;
            margin-bottom: 15px;
            animation: timeWarp 3s infinite;
        }

        @keyframes timeWarp {

            0%,
            100% {
                transform: rotate(-5deg) scale(1);
            }

            50% {
                transform: rotate(5deg) scale(1.1);
            }
        }

        .mission-title {
            font-family: 'Fredoka One', cursive;
            font-size: 1.4rem;
            color: #7b2cbf;
            margin-bottom: 8px;
        }

        .mission-desc {
            color: #666;
            margin-bottom: 15px;
        }

        .mission-reward {
            color: #ff9800;
            font-weight: 700;
        }

        .game-screen {
            display: none;
        }

        .game-screen.active {
            display: block;
            animation: warpIn 0.7s ease;
        }

        @keyframes warpIn {
            0% {
                opacity: 0;
                transform: scale(0.5) rotate(-10deg);
            }

            100% {
                opacity: 1;
                transform: scale(1) rotate(0);
            }
        }

        .game-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 30px;
            padding: 35px;
            color: #333;
            position: relative;
        }

        .close-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 45px;
            height: 45px;
            background: linear-gradient(45deg, #ff6b6b, #ffa64d);
            border: none;
            border-radius: 50%;
            font-size: 1.5rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .close-btn:hover {
            transform: scale(1.1) rotate(90deg);
        }

        .game-title {
            font-family: 'Fredoka One', cursive;
            font-size: 2rem;
            color: #7b2cbf;
            text-align: center;
            margin-bottom: 10px;
        }

        /* Lesson Box */
        .lesson-box {
            background: linear-gradient(145deg, #f3e5f5, #e1bee7);
            border-radius: 20px;
            padding: 25px;
            margin: 20px 0;
            border-left: 5px solid #9C27B0;
        }

        .lesson-title {
            font-family: 'Fredoka One', cursive;
            color: #7b1fa2;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .lesson-content {
            color: #333;
            line-height: 1.8;
        }

        .lesson-content p {
            margin-bottom: 15px;
        }

        .lesson-content ul {
            margin-left: 25px;
            margin-bottom: 15px;
        }

        .lesson-content li {
            margin-bottom: 8px;
        }

        .key-term {
            background: #fff9c4;
            padding: 2px 8px;
            border-radius: 5px;
            font-weight: 700;
            color: #f57f17;
        }

        .listen-btn {
            background: linear-gradient(45deg, #7b2cbf, #c77dff);
            color: #fff;
            border: none;
            padding: 12px 25px;
            border-radius: 50px;
            font-weight: 700;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            margin-top: 15px;
        }

        .listen-btn:hover {
            transform: scale(1.05);
        }

        .listen-btn.speaking {
            animation: pulse 1s infinite;
            background: linear-gradient(45deg, #ff6b9d, #ffa64d);
        }

        .game-instructions {
            text-align: center;
            color: #666;
            margin-bottom: 25px;
            background: #f3e5f5;
            padding: 15px;
            border-radius: 15px;
        }

        /* Timeline Game */
        .timeline-game {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            margin: 30px 0;
        }

        .timeline-event {
            display: flex;
            align-items: center;
            gap: 20px;
            padding: 20px 30px;
            background: linear-gradient(145deg, #f3e5f5, #e1bee7);
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
            width: 100%;
            max-width: 500px;
        }

        .timeline-event:hover {
            transform: scale(1.02);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
        }

        .timeline-event.placed {
            opacity: 0.5;
            pointer-events: none;
        }

        .event-icon {
            font-size: 3rem;
        }

        .event-text {
            font-weight: 700;
        }

        .timeline-slots {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 30px 0;
            flex-wrap: wrap;
        }

        .timeline-slot {
            width: 120px;
            height: 120px;
            border: 4px dashed #7b2cbf;
            border-radius: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .timeline-slot:hover {
            background: rgba(123, 44, 191, 0.1);
        }

        .timeline-slot.filled {
            border-style: solid;
            background: #c8e6c9;
        }

        .timeline-slot .slot-num {
            font-family: 'Fredoka One', cursive;
            font-size: 1.5rem;
            color: #7b2cbf;
        }

        .timeline-slot .slot-content {
            font-size: 2.5rem;
        }

        /* Then vs Now */
        .compare-game {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 25px 0;
        }

        .era-box {
            background: linear-gradient(145deg, #f3e5f5, #e1bee7);
            border-radius: 25px;
            padding: 30px;
            text-align: center;
        }

        .era-box h3 {
            font-family: 'Fredoka One', cursive;
            color: #7b2cbf;
            margin-bottom: 20px;
            font-size: 1.5rem;
        }

        .era-items {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        .era-item {
            background: #fff;
            padding: 20px;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .era-item:hover {
            transform: scale(1.05);
        }

        .era-item.active {
            border: 3px solid #7b2cbf;
        }

        .era-item.matched {
            background: #c8e6c9;
            animation: matchPop 0.5s;
        }

        @keyframes matchPop {
            0% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.2);
            }

            100% {
                transform: scale(1);
            }
        }

        .era-icon {
            font-size: 3rem;
            margin-bottom: 10px;
            display: block;
        }

        .era-label {
            font-weight: 700;
            font-size: 0.9rem;
        }

        /* Civilizations */
        .civ-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }

        .civ-card {
            background: linear-gradient(145deg, #fff, #f3e5f5);
            border-radius: 20px;
            padding: 25px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            border: 3px solid transparent;
        }

        .civ-card:hover {
            transform: translateY(-10px);
        }

        .civ-card.discovered {
            border-color: #4CAF50;
        }

        .civ-card.discovered::after {
            content: 'âœ…';
            position: absolute;
            top: 10px;
            right: 10px;
        }

        .civ-icon {
            font-size: 4rem;
            margin-bottom: 15px;
            display: block;
        }

        .civ-name {
            font-family: 'Fredoka One', cursive;
            color: #7b2cbf;
            margin-bottom: 10px;
        }

        .civ-fact {
            font-size: 0.9rem;
            color: #666;
            display: none;
        }

        .civ-card.discovered .civ-fact {
            display: block;
        }

        /* Map Explorer */
        .map-container {
            text-align: center;
            margin: 30px 0;
        }

        .map-pins {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
            margin-top: 30px;
        }

        .map-pin {
            padding: 20px 30px;
            background: linear-gradient(145deg, #fff, #f3e5f5);
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
        }

        .map-pin:hover {
            transform: scale(1.1);
        }

        .map-pin.explored {
            background: linear-gradient(145deg, #c8e6c9, #a5d6a7);
        }

        .map-pin-icon {
            font-size: 3rem;
            margin-bottom: 10px;
            display: block;
        }

        .map-pin-label {
            font-weight: 700;
        }

        .map-info {
            display: none;
            margin-top: 25px;
            padding: 25px;
            background: #f3e5f5;
            border-radius: 20px;
            animation: fadeIn 0.5s;
        }

        .map-info.show {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .reward-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            background: linear-gradient(145deg, #c77dff, #9c27b0);
            padding: 40px 60px;
            border-radius: 30px;
            text-align: center;
            z-index: 1000;
            color: #fff;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }

        .reward-popup.show {
            animation: popIn 0.5s forwards;
        }

        @keyframes popIn {
            0% {
                transform: translate(-50%, -50%) scale(0);
            }

            70% {
                transform: translate(-50%, -50%) scale(1.1);
            }

            100% {
                transform: translate(-50%, -50%) scale(1);
            }
        }

        .reward-stars {
            font-size: 4rem;
            margin-bottom: 15px;
        }

        .reward-title {
            font-family: 'Fredoka One', cursive;
            font-size: 1.8rem;
        }

        .reward-btn {
            margin-top: 20px;
            padding: 15px 40px;
            background: #fff;
            color: #7b2cbf;
            border: none;
            border-radius: 50px;
            font-family: 'Fredoka One', cursive;
            font-size: 1.1rem;
            cursor: pointer;
        }

        .confetti-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 999;
        }

        .confetti {
            position: absolute;
            width: 12px;
            height: 12px;
            animation: confettiFall 3s linear forwards;
        }

        @keyframes confettiFall {
            0% {
                transform: translateY(-50px) rotate(0deg);
                opacity: 1;
            }

            100% {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }

        .toast {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: linear-gradient(45deg, #7b2cbf, #c77dff);
            color: #fff;
            padding: 18px 35px;
            border-radius: 50px;
            font-weight: 700;
            z-index: 1000;
            opacity: 0;
            transition: all 0.4s;
        }

        .toast.show {
            transform: translateX(-50%) translateY(0);
            opacity: 1;
        }

        @media (max-width: 768px) {
            .compare-game {
                grid-template-columns: 1fr;
            }

            .teacher-bubble {
                max-width: 280px;
                font-size: 0.9rem;
            }
        }
    </style>
</head>

<body>
    <div class="top-bar">
        <a href="../" class="back-home">â† ğŸ  Home</a>
        <div class="game-stats">
            <div class="stat">â­ <span id="starsEarned">0</span>/12</div>
            <div class="stat">ğŸ¯ <span id="xpEarned">0</span> XP</div>
        </div>
    </div>

    <!-- Audio Controls -->
    <div class="audio-control">
        <button class="audio-btn" id="autoSpeakBtn" onclick="toggleAutoSpeak()">ğŸ”Š Auto-Read: OFF</button>
        <button class="audio-btn" onclick="stopSpeaking()">â¹ï¸ Stop</button>
    </div>

    <!-- Teacher Character -->
    <div class="teacher">
        <div class="teacher-bubble" id="teacherBubble">
            <div class="teacher-name">ğŸ“œ Professor History</div>
            <div id="teacherText">Welcome, time traveler! I'm Professor History. Together, we'll journey through time
                and explore amazing stories from the past!</div>
            <button class="speak-btn" id="speakBtn" onclick="speakTeacher()">ğŸ”Š Listen</button>
        </div>
        <div class="teacher-avatar" onclick="toggleTeacher()">ğŸ‘¨â€ğŸ«</div>
    </div>

    <div class="container">
        <div id="missionSelect">
            <div class="level-header">
                <h1 class="level-title">â° Time Machine ğŸš€</h1>
                <p class="level-subtitle">Travel through time and explore history! ğŸ†</p>
            </div>
            <div class="missions-grid">
                <div class="mission-card" onclick="startMission('timeline')" id="mission-timeline">
                    <div class="mission-icon">ğŸ“…ğŸ‘¶ğŸ‘¦ğŸ§”</div>
                    <h3 class="mission-title">My Timeline</h3>
                    <p class="mission-desc">Put life events in order!</p>
                    <div class="mission-reward">ğŸŒŸ +3 Stars | +50 XP</div>
                </div>
                <div class="mission-card" onclick="startMission('thenvsnow')" id="mission-thenvsnow">
                    <div class="mission-icon">ğŸ•¯ï¸ğŸ’¡</div>
                    <h3 class="mission-title">Then vs Now</h3>
                    <p class="mission-desc">Match old & new things!</p>
                    <div class="mission-reward">ğŸŒŸ +3 Stars | +50 XP</div>
                </div>
                <div class="mission-card" onclick="startMission('ancient')" id="mission-ancient">
                    <div class="mission-icon">ğŸ›ï¸ğŸ—¿ğŸ¯</div>
                    <h3 class="mission-title">Ancient Civilizations</h3>
                    <p class="mission-desc">Discover ancient people!</p>
                    <div class="mission-reward">ğŸŒŸ +3 Stars | +50 XP</div>
                </div>
                <div class="mission-card" onclick="startMission('map')" id="mission-map">
                    <div class="mission-icon">ğŸ—ºï¸ğŸŒğŸ§­</div>
                    <h3 class="mission-title">World Explorer</h3>
                    <p class="mission-desc">Explore the world map!</p>
                    <div class="mission-reward">ğŸŒŸ +3 Stars | +50 XP</div>
                </div>
            </div>
        </div>

        <!-- Timeline Game -->
        <div id="game-timeline" class="game-screen">
            <div class="game-container">
                <button class="close-btn" onclick="closeMission()">âœ•</button>
                <h2 class="game-title">ğŸ“… My Timeline - Life Events!</h2>

                <div class="lesson-box">
                    <div class="lesson-title">ğŸ“š What is a Timeline?</div>
                    <div class="lesson-content" id="timelineLesson">
                        <p>A <span class="key-term">timeline</span> shows events in the order they happened. It's like a
                            story of time!</p>
                        <p><strong>Your life has a timeline too!</strong></p>
                        <ul>
                            <li><strong>First</strong> - You were born as a baby ğŸ‘¶</li>
                            <li><strong>Then</strong> - You learned to walk and talk ğŸš¶</li>
                            <li><strong>Next</strong> - You started school and made friends ğŸ“</li>
                            <li><strong>Later</strong> - You'll learn to drive a car! ğŸš—</li>
                        </ul>
                        <p>Timelines help us understand <span class="key-term">history</span> - the story of what
                            happened before. When we put events in order, we can see how things change over time!</p>
                    </div>
                    <button class="listen-btn" onclick="speakLesson('timelineLesson')">ğŸ”Š Read to Me</button>
                </div>

                <div style="text-align:center;font-weight:700;font-size:1.2rem;margin-bottom:20px;">Progress: <span
                        id="timelineProgress">0</span>/4 ğŸ¯</div>
                <div class="timeline-slots" id="timelineSlots">
                    <div class="timeline-slot">
                        <div class="slot-num">1st</div>
                        <div class="slot-content" id="slot0">?</div>
                    </div>
                    <div class="timeline-slot">
                        <div class="slot-num">2nd</div>
                        <div class="slot-content" id="slot1">?</div>
                    </div>
                    <div class="timeline-slot">
                        <div class="slot-num">3rd</div>
                        <div class="slot-content" id="slot2">?</div>
                    </div>
                    <div class="timeline-slot">
                        <div class="slot-num">4th</div>
                        <div class="slot-content" id="slot3">?</div>
                    </div>
                </div>
                <div class="timeline-game" id="timelineEvents">
                    <div class="timeline-event" onclick="placeEvent(this, 2, 'ğŸ“')">
                        <div class="event-icon">ğŸ“</div>
                        <div class="event-text">Go to School</div>
                    </div>
                    <div class="timeline-event" onclick="placeEvent(this, 0, 'ğŸ‘¶')">
                        <div class="event-icon">ğŸ‘¶</div>
                        <div class="event-text">Baby is Born</div>
                    </div>
                    <div class="timeline-event" onclick="placeEvent(this, 3, 'ğŸš—')">
                        <div class="event-icon">ğŸš—</div>
                        <div class="event-text">Learn to Drive</div>
                    </div>
                    <div class="timeline-event" onclick="placeEvent(this, 1, 'ğŸš¶')">
                        <div class="event-icon">ğŸš¶</div>
                        <div class="event-text">Learn to Walk</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Then vs Now -->
        <div id="game-thenvsnow" class="game-screen">
            <div class="game-container">
                <button class="close-btn" onclick="closeMission()">âœ•</button>
                <h2 class="game-title">ğŸ•¯ï¸ Then vs Now ğŸ’¡</h2>

                <div class="lesson-box">
                    <div class="lesson-title">ğŸ“š How Things Change Over Time</div>
                    <div class="lesson-content" id="thenvsnowLesson">
                        <p>Long ago, people lived very differently! <span class="key-term">Technology</span> and
                            inventions have changed our world:</p>
                        <ul>
                            <li><strong>ğŸ•¯ï¸ Candles â†’ ğŸ’¡ Light Bulbs</strong> - Now we flip a switch for bright light!
                            </li>
                            <li><strong>ğŸ´ Horses â†’ ğŸš— Cars</strong> - Travel is much faster today!</li>
                            <li><strong>âœ‰ï¸ Letters â†’ ğŸ“§ Email</strong> - Messages arrive in seconds, not weeks!</li>
                            <li><strong>ğŸª¶ Quill Pens â†’ âŒ¨ï¸ Keyboards</strong> - We can write much faster now!</li>
                        </ul>
                        <p>These changes happened because smart people kept <span class="key-term">inventing</span> new
                            and better ways to do things. Maybe YOU will invent something amazing one day!</p>
                    </div>
                    <button class="listen-btn" onclick="speakLesson('thenvsnowLesson')">ğŸ”Š Read to Me</button>
                </div>

                <div style="text-align:center;font-weight:700;font-size:1.2rem;margin-bottom:20px;">Matched: <span
                        id="matchProgress">0</span>/4 ğŸ¯</div>
                <div class="compare-game">
                    <div class="era-box">
                        <h3>ğŸ“œ LONG AGO</h3>
                        <div class="era-items">
                            <div class="era-item" onclick="clickMatch(this,'candle','old')"><span
                                    class="era-icon">ğŸ•¯ï¸</span><span class="era-label">Candle</span></div>
                            <div class="era-item" onclick="clickMatch(this,'horse','old')"><span
                                    class="era-icon">ğŸ´</span><span class="era-label">Horse</span></div>
                            <div class="era-item" onclick="clickMatch(this,'letter','old')"><span
                                    class="era-icon">âœ‰ï¸</span><span class="era-label">Letter</span></div>
                            <div class="era-item" onclick="clickMatch(this,'quill','old')"><span
                                    class="era-icon">ğŸª¶</span><span class="era-label">Quill Pen</span></div>
                        </div>
                    </div>
                    <div class="era-box">
                        <h3>ğŸ“± TODAY</h3>
                        <div class="era-items">
                            <div class="era-item" onclick="clickMatch(this,'letter','new')"><span
                                    class="era-icon">ğŸ“§</span><span class="era-label">Email</span></div>
                            <div class="era-item" onclick="clickMatch(this,'candle','new')"><span
                                    class="era-icon">ğŸ’¡</span><span class="era-label">Light Bulb</span></div>
                            <div class="era-item" onclick="clickMatch(this,'quill','new')"><span
                                    class="era-icon">âŒ¨ï¸</span><span class="era-label">Keyboard</span></div>
                            <div class="era-item" onclick="clickMatch(this,'horse','new')"><span
                                    class="era-icon">ğŸš—</span><span class="era-label">Car</span></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Ancient Civilizations -->
        <div id="game-ancient" class="game-screen">
            <div class="game-container">
                <button class="close-btn" onclick="closeMission()">âœ•</button>
                <h2 class="game-title">ğŸ›ï¸ Ancient Civilizations</h2>

                <div class="lesson-box">
                    <div class="lesson-title">ğŸ“š People From Long, Long Ago</div>
                    <div class="lesson-content" id="ancientLesson">
                        <p>Thousands of years ago, amazing <span class="key-term">civilizations</span> built incredible
                            things that still exist today!</p>
                        <ul>
                            <li><strong>ğŸ›ï¸ Ancient Greece</strong> - They invented the Olympic Games and built
                                beautiful temples! Greek thinkers also gave us ideas about math and science.</li>
                            <li><strong>ğŸ”º Ancient Egypt</strong> - They built the giant pyramids as tombs for their
                                kings called pharaohs. They also invented a picture writing called hieroglyphics!</li>
                            <li><strong>ğŸ—¿ Easter Island</strong> - People here carved huge stone statues called Moai.
                                Some are as tall as a 4-story building!</li>
                            <li><strong>ğŸ¯ Ancient China</strong> - They built the Great Wall, which is so long you can
                                see it from space! They also invented paper and fireworks.</li>
                        </ul>
                        <p>These ancient people were very clever and creative, just like you!</p>
                    </div>
                    <button class="listen-btn" onclick="speakLesson('ancientLesson')">ğŸ”Š Read to Me</button>
                </div>

                <div style="text-align:center;font-weight:700;font-size:1.2rem;margin-bottom:20px;">Discovered: <span
                        id="civProgress">0</span>/4 ğŸ¯</div>
                <div class="civ-cards">
                    <div class="civ-card"
                        onclick="discoverCiv(this, 'Ancient Greece invented the Olympic Games! Athletes competed in running, wrestling, and chariot races.')">
                        <span class="civ-icon">ğŸ›ï¸</span>
                        <div class="civ-name">Ancient Greece</div>
                        <div class="civ-fact">Invented the Olympics!</div>
                    </div>
                    <div class="civ-card"
                        onclick="discoverCiv(this, 'Ancient Egypt built the pyramids! These huge tombs took thousands of workers many years to build.')">
                        <span class="civ-icon">ğŸ”º</span>
                        <div class="civ-name">Ancient Egypt</div>
                        <div class="civ-fact">Built the pyramids!</div>
                    </div>
                    <div class="civ-card"
                        onclick="discoverCiv(this, 'Easter Island has giant stone statues called Moai. Nobody knows exactly how they moved such heavy stones!')">
                        <span class="civ-icon">ğŸ—¿</span>
                        <div class="civ-name">Easter Island</div>
                        <div class="civ-fact">Made giant statues!</div>
                    </div>
                    <div class="civ-card"
                        onclick="discoverCiv(this, 'Ancient China built the Great Wall to protect their land. It stretches over 13,000 miles!')">
                        <span class="civ-icon">ğŸ¯</span>
                        <div class="civ-name">Ancient China</div>
                        <div class="civ-fact">Built the Great Wall!</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- World Map -->
        <div id="game-map" class="game-screen">
            <div class="game-container">
                <button class="close-btn" onclick="closeMission()">âœ•</button>
                <h2 class="game-title">ğŸ—ºï¸ World Explorer</h2>

                <div class="lesson-box">
                    <div class="lesson-title">ğŸ“š Our Amazing Planet!</div>
                    <div class="lesson-content" id="mapLesson">
                        <p>Earth has 7 large pieces of land called <span class="key-term">continents</span>. Each one
                            has special animals, foods, and people!</p>
                        <ul>
                            <li><strong>ğŸ¦ Africa</strong> - Home to lions, elephants, and giraffes! It also has the
                                Sahara Desert and the Nile River.</li>
                            <li><strong>ğŸ¼ Asia</strong> - The biggest continent! It has pandas in China, tigers in
                                India, and Mount Everest - the tallest mountain.</li>
                            <li><strong>ğŸ° Europe</strong> - Known for castles, the Eiffel Tower, and lots of history.
                                Many fairy tales come from here!</li>
                            <li><strong>ğŸ—½ Americas</strong> - North and South America have the Amazon rainforest, the
                                Grand Canyon, and the Statue of Liberty.</li>
                            <li><strong>ğŸ¦˜ Oceania</strong> - Australia has kangaroos and koalas! It also has the Great
                                Barrier Reef with colorful fish.</li>
                        </ul>
                        <p>Explorers travel to learn about different places and cultures. You can be an explorer too!
                        </p>
                    </div>
                    <button class="listen-btn" onclick="speakLesson('mapLesson')">ğŸ”Š Read to Me</button>
                </div>

                <div style="text-align:center;font-weight:700;font-size:1.2rem;margin-bottom:20px;">Explored: <span
                        id="mapProgress">0</span>/5 ğŸ¯</div>
                <div class="map-container">
                    <div style="font-size:10rem;">ğŸ—ºï¸</div>
                    <div class="map-pins">
                        <div class="map-pin" onclick="explorePlace(this,'africa')"><span
                                class="map-pin-icon">ğŸ¦</span><span class="map-pin-label">Africa</span></div>
                        <div class="map-pin" onclick="explorePlace(this,'asia')"><span
                                class="map-pin-icon">ğŸ¼</span><span class="map-pin-label">Asia</span></div>
                        <div class="map-pin" onclick="explorePlace(this,'europe')"><span
                                class="map-pin-icon">ğŸ°</span><span class="map-pin-label">Europe</span></div>
                        <div class="map-pin" onclick="explorePlace(this,'americas')"><span
                                class="map-pin-icon">ğŸ—½</span><span class="map-pin-label">Americas</span></div>
                        <div class="map-pin" onclick="explorePlace(this,'oceania')"><span
                                class="map-pin-icon">ğŸ¦˜</span><span class="map-pin-label">Oceania</span></div>
                    </div>
                    <div class="map-info" id="mapInfo"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="reward-popup" id="rewardPopup">
        <div class="reward-stars">â­â­â­</div>
        <div class="reward-title">Time Travel Complete!</div>
        <div class="reward-score">+50 XP Earned!</div>
        <button class="reward-btn" onclick="closeReward()">AWESOME! ğŸ‰</button>
    </div>

    <div class="confetti-container" id="confetti"></div>
    <div class="toast" id="toast"></div>

    <script>
        // ===== TEXT-TO-SPEECH =====
        let autoSpeak = false;

        function speak(text, onEnd) {
            stopSpeaking();
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.rate = 0.9;
                utterance.pitch = 1.1;
                const voices = speechSynthesis.getVoices();
                const preferred = voices.find(v => v.name.includes('Google') || v.name.includes('Female'));
                if (preferred) utterance.voice = preferred;
                if (onEnd) utterance.onend = onEnd;
                speechSynthesis.speak(utterance);
            }
        }

        function stopSpeaking() {
            if ('speechSynthesis' in window) speechSynthesis.cancel();
            document.querySelectorAll('.listen-btn, .speak-btn').forEach(b => b.classList.remove('speaking'));
        }

        function toggleAutoSpeak() {
            autoSpeak = !autoSpeak;
            const btn = document.getElementById('autoSpeakBtn');
            btn.textContent = 'ğŸ”Š Auto-Read: ' + (autoSpeak ? 'ON' : 'OFF');
            btn.classList.toggle('active', autoSpeak);
            if (autoSpeak) showToast('ğŸ”Š I\'ll read lessons to you automatically!');
        }

        function speakLesson(lessonId) {
            const lesson = document.getElementById(lessonId);
            if (!lesson) return;
            const btn = lesson.parentElement.querySelector('.listen-btn');
            btn.classList.add('speaking');
            speak(lesson.innerText, () => btn.classList.remove('speaking'));
        }

        // Teacher Character
        let teacherVisible = false;
        const teacherMessages = {
            welcome: "Welcome, time traveler! I'm Professor History. Together, we'll journey through time and explore amazing stories from the past!",
            timeline: "Excellent! Let's learn about timelines. Think about your own life - what happened first, second, third? That's your personal history!",
            thenvsnow: "Isn't it amazing how things change? Long ago, people lived so differently. Let's match old things with their modern versions!",
            ancient: "Get ready to meet some incredible ancient people! They built amazing things thousands of years ago that we can still see today.",
            map: "Time to explore our world! Each continent has unique animals, foods, and people. Where would you like to visit?"
        };

        function toggleTeacher() {
            const bubble = document.getElementById('teacherBubble');
            teacherVisible = !teacherVisible;
            bubble.classList.toggle('show', teacherVisible);
        }

        function speakTeacher() {
            const text = document.getElementById('teacherText').innerText;
            const btn = document.getElementById('speakBtn');
            btn.classList.add('speaking');
            speak(text, () => btn.classList.remove('speaking'));
        }

        function teacherSay(message) {
            document.getElementById('teacherText').textContent = message;
            document.getElementById('teacherBubble').classList.add('show');
            teacherVisible = true;
            if (autoSpeak) setTimeout(() => speak(message), 500);
        }

        setTimeout(() => teacherSay(teacherMessages.welcome), 1000);

        // ===== GAME LOGIC =====
        let totalStars = parseInt(localStorage.getItem('history_stars') || 0);
        let totalXP = parseInt(localStorage.getItem('history_xp') || 0);
        let completedMissions = JSON.parse(localStorage.getItem('history_completed') || '[]');

        function updateStats() {
            document.getElementById('starsEarned').textContent = totalStars;
            document.getElementById('xpEarned').textContent = totalXP;
            completedMissions.forEach(m => {
                const card = document.getElementById('mission-' + m);
                if (card) card.classList.add('completed');
            });
        }
        updateStats();

        function startMission(id) {
            document.getElementById('missionSelect').style.display = 'none';
            document.getElementById('game-' + id).classList.add('active');
            teacherSay(teacherMessages[id]);
            if (autoSpeak) {
                setTimeout(() => {
                    const lessonMap = { timeline: 'timelineLesson', thenvsnow: 'thenvsnowLesson', ancient: 'ancientLesson', map: 'mapLesson' };
                    if (lessonMap[id]) speakLesson(lessonMap[id]);
                }, 2000);
            }
        }

        function closeMission() {
            stopSpeaking();
            document.querySelectorAll('.game-screen').forEach(g => g.classList.remove('active'));
            document.getElementById('missionSelect').style.display = 'block';
            teacherSay("Wonderful exploring! Pick another time period to visit!");
        }

        function showToast(msg) {
            const t = document.getElementById('toast');
            t.textContent = msg; t.classList.add('show');
            setTimeout(() => t.classList.remove('show'), 2500);
        }

        function createConfetti(count) {
            const colors = ['#c77dff', '#ff6b9d', '#ffd54f', '#69f0ae', '#4fc3f7'];
            const container = document.getElementById('confetti');
            for (let i = 0; i < count; i++) {
                const el = document.createElement('div');
                el.className = 'confetti';
                el.style.left = Math.random() * 100 + '%';
                el.style.background = colors[Math.floor(Math.random() * colors.length)];
                container.appendChild(el);
                setTimeout(() => el.remove(), 3000);
            }
        }

        function completeMission(missionId) {
            if (!completedMissions.includes(missionId)) {
                completedMissions.push(missionId);
                totalStars += 3;
                totalXP += 50;
                localStorage.setItem('history_stars', totalStars);
                localStorage.setItem('history_xp', totalXP);
                localStorage.setItem('history_completed', JSON.stringify(completedMissions));
                updateStats();
                document.getElementById('rewardPopup').classList.add('show');
                createConfetti(50);
                speak("Congratulations! You completed the mission and earned 3 stars!");
            }
        }

        function closeReward() {
            document.getElementById('rewardPopup').classList.remove('show');
            closeMission();
        }

        // Timeline Game
        let timelineStep = 0;
        function placeEvent(el, correctPosition, emoji) {
            if (correctPosition === timelineStep) {
                el.classList.add('placed');
                document.getElementById('slot' + timelineStep).textContent = emoji;
                document.querySelectorAll('.timeline-slot')[timelineStep].classList.add('filled');
                timelineStep++;
                document.getElementById('timelineProgress').textContent = timelineStep;
                const messages = ['First, a baby is born!', 'Then you learn to walk!', 'Next comes school!', 'Finally, driving when you\'re older!'];
                showToast('âœ… ' + messages[correctPosition]);
                if (autoSpeak) speak(messages[correctPosition]);
                if (timelineStep >= 4) completeMission('timeline');
            } else {
                showToast('âŒ Not quite! Think about what happens first!');
            }
        }

        // Then vs Now Matching
        let selectedOld = null;
        let matchProgress = 0;
        function clickMatch(el, matchId, era) {
            if (el.classList.contains('matched')) return;

            if (era === 'old') {
                document.querySelectorAll('.era-item').forEach(e => e.classList.remove('active'));
                el.classList.add('active');
                selectedOld = { element: el, id: matchId };
                showToast('ğŸ‘† Now click the matching modern item!');
            } else if (selectedOld) {
                if (selectedOld.id === matchId) {
                    selectedOld.element.classList.add('matched');
                    selectedOld.element.classList.remove('active');
                    el.classList.add('matched');
                    matchProgress++;
                    document.getElementById('matchProgress').textContent = matchProgress;
                    const matchMessages = { candle: 'Candles became light bulbs!', horse: 'Horses became cars!', letter: 'Letters became email!', quill: 'Quill pens became keyboards!' };
                    showToast('ğŸ‰ ' + matchMessages[matchId]);
                    if (autoSpeak) speak(matchMessages[matchId]);
                    selectedOld = null;
                    if (matchProgress >= 4) completeMission('thenvsnow');
                } else {
                    showToast('âŒ Those don\'t match! Try again.');
                    selectedOld.element.classList.remove('active');
                    selectedOld = null;
                }
            } else {
                showToast('ğŸ‘† First click an OLD item!');
            }
        }

        // Civilizations
        let civProgress = 0;
        function discoverCiv(el, fact) {
            if (!el.classList.contains('discovered')) {
                el.classList.add('discovered');
                civProgress++;
                document.getElementById('civProgress').textContent = civProgress;
                showToast('ğŸ›ï¸ Civilization discovered!');
                if (autoSpeak) speak(fact);
                if (civProgress >= 4) completeMission('ancient');
            }
        }

        // World Map
        let mapProgress = 0;
        const placeInfo = {
            africa: 'ğŸ¦ Africa is home to lions, elephants, and giraffes! The Sahara Desert here is the biggest hot desert in the world!',
            asia: 'ğŸ¼ Asia is the biggest continent! It has pandas, the Great Wall of China, and Mount Everest - the tallest mountain!',
            europe: 'ğŸ° Europe has amazing castles, the Eiffel Tower in France, and Big Ben in England! Many fairy tales came from here!',
            americas: 'ğŸ—½ The Americas have the Amazon rainforest with millions of animals, the Grand Canyon, and the Statue of Liberty!',
            oceania: 'ğŸ¦˜ Oceania includes Australia with kangaroos and koalas! The Great Barrier Reef here has the most colorful fish!'
        };
        function explorePlace(el, place) {
            const info = placeInfo[place];
            document.getElementById('mapInfo').textContent = info;
            document.getElementById('mapInfo').classList.add('show');

            if (!el.classList.contains('explored')) {
                el.classList.add('explored');
                mapProgress++;
                document.getElementById('mapProgress').textContent = mapProgress;
                showToast('ğŸ—ºï¸ ' + place.charAt(0).toUpperCase() + place.slice(1) + ' explored!');
                if (autoSpeak) speak(info);
                if (mapProgress >= 5) completeMission('map');
            }
        }

        if ('speechSynthesis' in window) {
            speechSynthesis.getVoices();
            speechSynthesis.onvoiceschanged = () => speechSynthesis.getVoices();
        }
    </script>
</body>

</html>
